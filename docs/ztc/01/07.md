# 数据库物理外键移除原因

这里准备好了我们此阶段需要使用的表结构，可以先大概看一下下图

![](./assets/bjg.png)

pdman 项目文件在 GitHub 仓库的 [此页面同级目录](https://github.com/zq99299/note-architect/tree/main/docs/ztc/01) 下，文件名称是 [pdm.json](https://raw.githubusercontent.com/zq99299/note-architect/main/docs/ztc/01/pdm.json) ，可以使用 pdamn 直接打开该文件，就能看到如上图所示的表结构设计了。

## 数据库外键

这里可以看到都没有 **添加数据库外键**，原因基于以下几点考虑：

- 性能影响：在分布式项目里、在大型的互联网项目里面，对于整体的性能会有一定的影响

- 热更新：不停机维护

  热更新时某些场景下的外键可能会影响到还没有更新的实例。

  因为外键是强一致性的，和分布式是冲突的
  
- 降低耦合度

  物理外键不存在，但是在逻辑上还是需要的
  
- 数据分库分表

  由于耦合度太高，做分裤分表时，就很难做了。

  比如：用户表和用户地址，如果有物理外键，你只能将同一个关系的数据都分片到同一个库的同一个表中，这就大大的限制了灵活性

  

